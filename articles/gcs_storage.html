<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Google Cloud Storage • daiR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Working with Google Cloud Storage">
<meta property="og:description" content="daiR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NL6TR4PT51"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NL6TR4PT51');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">daiR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/configuration.html">Configuration</a>
    </li>
    <li>
      <a href="../articles/gcs_storage.html">Working with Google Cloud Storage</a>
    </li>
    <li>
      <a href="../articles/usage.html">Basic usage</a>
    </li>
    <li>
      <a href="../articles/tables.html">Extracting tables</a>
    </li>
    <li>
      <a href="../articles/reconstructing_text.html">Correcting text output</a>
    </li>
    <li>
      <a href="../articles/searchable_pdfs.html">Creating searchable PDFs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/faqs.html">FAQs</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/hegghammer/dair/" class="external-link">
    <span class="fab fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Hegghammer/daiR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with Google Cloud Storage</h1>
                        <h4 data-toc-skip class="author">Thomas
Hegghammer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Hegghammer/daiR/blob/HEAD/vignettes/gcs_storage.Rmd" class="external-link"><code>vignettes/gcs_storage.Rmd</code></a></small>
      <div class="hidden name"><code>gcs_storage.Rmd</code></div>

    </div>

    
    
<p><em>Last updated 10 February 2024</em><br><br></p>
<p>To make the most of Document AI API, it is worth familiarizing
yourself with Google Cloud Storage, because this is what allows you to
process documents asynchronously (more on this in the <a href="https://dair.info/articles/usage.html" class="external-link">usage vignette</a>). <a href="https://cloud.google.com/storage" class="external-link">Google Cloud Storage</a> – not
to be confused with Google Drive – is a central feature of Google Cloud
Services (GCS); it serves as a kind of mailbox where you deposit files
for processing with any one of the GCS APIs and retrieve the output from
the processing you requested. In the context of OCR processing with
<code>daiR</code>, a typical asynchronous workflow consists of uploading
documents to a Storage bucket, telling Document AI where to find them,
and downloading the JSON output files afterwards. To interact with
Google Storage we use the <code>googleCloudStorageR</code> <a href="https://code.markedmondson.me/googleCloudStorageR/" class="external-link">package</a>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Storage is such a fundamental service in GCS that it is enabled by
default. If you followed the <a href="https://dair.info/articles/configuration.html" class="external-link">configuration
vignette</a> where you created a GCS account and stored an environmental
variable <code>GCS_AUTH_FILE</code> in your <code>.Renviron</code> file,
you are pretty much ready to go. All you need to do is load
<code>googleCloudStorageR</code> and you will be auto-authenticated.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://code.markedmondson.me/googleCloudStorageR/" class="external-link">googleCloudStorageR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-and-inspecting-buckets">Creating and inspecting buckets<a class="anchor" aria-label="anchor" href="#creating-and-inspecting-buckets"></a>
</h2>
<p>Google Storage keeps your files in so-called “buckets”, which you can
think of as folders. There is no root location in your Google Storage
space, so you need at least one bucket to store files.</p>
<p>To view and create buckets, you need your <em>project id</em>, which
we encountered in step 3 in the <a href="https://dair.info/articles/configuration.html" class="external-link">configuration
vignette</a>. If you did not store it when setting up GCS, you can look
it up in the Google Cloud Console or use the <code>daiR</code> function
<code><a href="../reference/get_project_id.html">get_project_id()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_id</span> <span class="op">&lt;-</span> <span class="fu">daiR</span><span class="fu">::</span><span class="fu"><a href="../reference/get_project_id.html">get_project_id</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s see how many buckets we have:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_buckets.html" class="external-link">gcs_list_buckets</a></span><span class="op">(</span><span class="va">project_id</span><span class="op">)</span></span></code></pre></div>
<p>Answer: zero, because we haven’t created one yet. This we can do with
<code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_create_bucket.html" class="external-link">gcs_create_bucket()</a></code>. Note that it has to be globally unique
(“my_bucket” won’t work because someone’s already taken it). For this
example, let’s use “example-bucket-34869” (change the number so you get
a unique one). Also add a location (“eu” or “us”).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_create_bucket.html" class="external-link">gcs_create_bucket</a></span><span class="op">(</span><span class="st">"example-bucket-34869"</span>, <span class="va">project_id</span>, location <span class="op">=</span> <span class="st">"eu"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can see the bucket listed:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_buckets.html" class="external-link">gcs_list_buckets</a></span><span class="op">(</span><span class="va">project_id</span><span class="op">)</span></span></code></pre></div>
<p>You can create as many buckets as you want and organize them as you
like. But you will need to supply a bucket name with every call to
Google Storage (and Document AI), so you may want to store the name of a
default bucket in the environment. Here you have two options:</p>
<ol style="list-style-type: decimal">
<li><p>Set it for the current session with
<code>gcs_global_bucket("&lt;your bucket name&gt;")</code></p></li>
<li><p>Store it permanently in you .Renviron file by calling
<code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code> and adding
<code>GCS_DEFAULT_BUCKET=&lt;your bucket name&gt;</code> to the list of
variables (just as you did with <code>GCS_AUTH_FILE</code> and
<code>DAI_PROCESSOR_ID</code> in the <a href="https://dair.info/articles/configuration.html" class="external-link">configuration
vignette</a>). Note that adding a default bucket to .Renviron will not
prevent you from supplying other bucket names in individual calls to
Google Storage when necessary.</p></li>
</ol>
<p>To get a bucket’s file inventory, we use
<code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects()</a></code>. Leaving the parentheses empty will get
information about the default bucket if you have set it.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>At this point it’s obviously empty, so let’s upload something.</p>
</div>
<div class="section level2">
<h2 id="uploading-files">Uploading files<a class="anchor" aria-label="anchor" href="#uploading-files"></a>
</h2>
<p>This we do with <code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload()</a></code>. If the file is in your
working directory, just write the filename; otherwise provide the full
file path. If you want, you can store the file under another name in
Google Storage with the <code>name</code> parameter; otherwise, just
leave the parameter out. For this example we create a simple CSV file
and upload it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mtcars.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s check the contents.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Note that you can use the parameter <code>name</code> to change the
name that the file will be stored under in the bucket.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span>, name <span class="op">=</span> <span class="st">"testfile.csv"</span><span class="op">)</span></span></code></pre></div>
<p>The Google Storage API handles only one file at a time, so for bulk
uploads you need to use iteration. Let’s create another CSV file, create
a vector with the two files, and map over it.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"iris.csv"</span><span class="op">)</span></span>
<span><span class="va">my_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"*.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">my_files</span>, <span class="va">gcs_upload</span><span class="op">)</span></span></code></pre></div>
<p>Note that if your <code>my_files</code> vector contains full
filepaths, not specifying the <code>name</code> parameter in
<code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload()</a></code> will produce long and awkward filenames in the
Storage bucket. To avoid this, use <code><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename()</a></code> in the name
parameter, like so:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">my_files</span>, <span class="op">~</span> <span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload</a></span><span class="op">(</span><span class="va">.x</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check the contents again:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Note that there’s a file size limit of 5Mb, but you can change it
with <code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload_set_limit()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_upload.html" class="external-link">gcs_upload_set_limit</a></span><span class="op">(</span>upload_limit <span class="op">=</span> <span class="fl">20000000L</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="downloading-files">Downloading files<a class="anchor" aria-label="anchor" href="#downloading-files"></a>
</h2>
<p>Downloads are performed with <code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_get_object.html" class="external-link">gcs_get_object()</a></code>. Note that
you need to explicitly provide the name that your file will be saved
under using the parameter <code>saveToDisk</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_get_object.html" class="external-link">gcs_get_object</a></span><span class="op">(</span><span class="st">"iris.csv"</span>, saveToDisk <span class="op">=</span> <span class="st">"iris.csv"</span><span class="op">)</span></span></code></pre></div>
<p>If you want the file somewhere other than your working directory,
just provide a path. You can also change the file’s basename if you
want.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_get_object.html" class="external-link">gcs_get_object</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span>, saveToDisk <span class="op">=</span> <span class="st">"/path/to/mtcars_downloaded.csv"</span><span class="op">)</span></span></code></pre></div>
<p>To download multiple files we again need to use iteration. Here it
helps to know that the “bucket inventory” function,
<code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects()</a></code>, returns a dataframe with a column
called <code>name</code>. If you store the output of this function as an
object, e.g. <code>contents</code>, you can access the filenames with
<code>contents$name</code>. To download all the files in the bucket to
our working directory, we would do something like this:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">contents</span><span class="op">$</span><span class="va">name</span>, <span class="op">~</span> <span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_get_object.html" class="external-link">gcs_get_object</a></span><span class="op">(</span><span class="va">.x</span>, saveToDisk <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If files with the same names exist in the destination drive, the
process will fail (to protect your local files). Add
<code>overwrite = TRUE</code> if you don’t mind overwriting them.</p>
<p>Note that files in a Google Storage bucket can have names that
include forward slashes. The JSON files returned by Document AI, for
example, can look like this:
<code>17346859889898929078/0/document-0.json</code>. If you try to save
such a file under its full filename, your computer will think the
slashes are folder separators, look for matching folder names, and give
an error if those folders (in this case
<code>17346859889898929078</code> and <code>0</code>) don’t already
exist on your drive. To avoid this and get file simply as
<code>document-0.json</code>, use <code>basename(.x)</code> in the
<code>saveToDisk</code> parameter of <code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_get_object.html" class="external-link">gcs_get_object()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">map</span>(contents<span class="sc">$</span>name, <span class="sc">~</span> <span class="fu">gcs_get_object</span>(.x, <span class="at">saveToDisk =</span> <span class="fu">basename</span>(.x))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="deleting">Deleting<a class="anchor" aria-label="anchor" href="#deleting"></a>
</h2>
<p>We can delete files in the bucket with
<code><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_delete_object.html" class="external-link">gcs_delete_object()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_delete_object.html" class="external-link">gcs_delete_object</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span><span class="op">)</span></span></code></pre></div>
<p>To delete several, we again need to loop or map. The following code
deletes everything in the bucket.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">contents</span><span class="op">$</span><span class="va">name</span>, <span class="va">gcs_delete_object</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="convenience-functions">Convenience functions<a class="anchor" aria-label="anchor" href="#convenience-functions"></a>
</h2>
<p>You can always create custom functions for frequently used
operations. For example, I like to start a new OCR project with an empty
bucket, so I have the following function in my
<code>.Rprofile</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">empty_bucket</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">contents</span> <span class="op">&lt;-</span> <span class="fu">googleCloudStorageR</span><span class="fu">::</span><span class="fu"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_list_objects.html" class="external-link">gcs_list_objects</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">contents</span><span class="op">$</span><span class="va">name</span>, <span class="fu">googleCloudStorageR</span><span class="fu">::</span><span class="va"><a href="https://cloudyr.github.io/googleCloudStorageR//reference/gcs_delete_object.html" class="external-link">gcs_delete_object</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Google Storage has many other functionalities, and I recommend
exploring the documentation of <code>googleCloudStorageR</code> to find
out more. But we have covered the essential ones, and you are now ready
to make full use of <code>daiR</code>. Take a look at the vignette on <a href="https://dair.info/articles/usage.html" class="external-link">basic usage</a> to get
started.</p>
</div>
<div class="section level2">
<h2 id="cheatsheet">Cheatsheet<a class="anchor" aria-label="anchor" href="#cheatsheet"></a>
</h2>
<p>If you are confused about the various ids and variables in the GCS
ecosystem, refer to the <a href="https://dair.info/articles/cheatsheet.html" class="external-link">concept
cheatsheet</a>.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>It is possible to manually upload and download files to
Google Storage in the <a href="https://console.cloud.google.com/storage" class="external-link">Google Cloud
Console</a>. For uploads this can sometimes be easier than doing it
programmatically, but downloads and deletions will be cumbersome.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Hegghammer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
