<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>OCR asynchronously and get table data — dai_async_tab • daiR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="OCR asynchronously and get table data — dai_async_tab"><meta property="og:description" content="Sends files from a Google Cloud Services (GCS) Storage
bucket to the GCS Document AI v1beta2 API for asynchronous (offline)
processing. The output is delivered to the same bucket as JSON files
containing the OCRed text and additional information, including
table-related data."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NL6TR4PT51"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NL6TR4PT51');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">daiR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/basics.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/setting_up_google_storage.html">Setting up a Google Storage bucket</a>
    </li>
    <li>
      <a href="../articles/using_document_ai.html">Using Google Document AI with R</a>
    </li>
    <li>
      <a href="../articles/extracting_tables.html">Extracting tables</a>
    </li>
    <li>
      <a href="../articles/reconstructing_text.html">Correcting text output from Google Document AI</a>
    </li>
    <li>
      <a href="../articles/complex_file_and_folder_management.html">Complex file and folder management</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/faqs.html">FAQs</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/hegghammer/dair/" class="external-link">
    <span class="fab fa-github"></span>
     
    Github
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Hegghammer/daiR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>OCR asynchronously and get table data</h1>
    <small class="dont-index">Source: <a href="https://github.com/Hegghammer/daiR/blob/HEAD/R/send_to_dai.R" class="external-link"><code>R/send_to_dai.R</code></a></small>
    <div class="hidden name"><code>dai_async_tab.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sends files from a Google Cloud Services (GCS) Storage
bucket to the GCS Document AI v1beta2 API for asynchronous (offline)
processing. The output is delivered to the same bucket as JSON files
containing the OCRed text and additional information, including
table-related data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dai_async_tab</span><span class="op">(</span></span>
<span>  <span class="va">files</span>,</span>
<span>  filetype <span class="op">=</span> <span class="st">"pdf"</span>,</span>
<span>  dest_folder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bucket <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GCS_DEFAULT_BUCKET"</span><span class="op">)</span>,</span>
<span>  proj_id <span class="op">=</span> <span class="fu"><a href="get_project_id.html">get_project_id</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  loc <span class="op">=</span> <span class="st">"eu"</span>,</span>
<span>  token <span class="op">=</span> <span class="fu"><a href="dai_token.html">dai_token</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pps <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>files</dt>
<dd><p>A vector or list of pdf filepaths in a GCS Storage bucket.
Filepaths must include all parent bucket folder(s) except the bucket name.</p></dd>


<dt>filetype</dt>
<dd><p>Either "pdf", "gif", or "tiff". If <code>files</code> is a
vector, all elements must be of the same type.</p></dd>


<dt>dest_folder</dt>
<dd><p>The name of the bucket subfolder where you want the
JSON output.</p></dd>


<dt>bucket</dt>
<dd><p>The name of the GCS Storage bucket. Not necessary if
you have set a default bucket as a .Renviron variable named
<code>GCS_DEFAULT_BUCKET</code> as described in the package vignette</p></dd>


<dt>proj_id</dt>
<dd><p>a GCS project id</p></dd>


<dt>loc</dt>
<dd><p>a two-letter region code ("eu" or "us")</p></dd>


<dt>token</dt>
<dd><p>an access token generated by <code><a href="dai_auth.html">dai_auth()</a></code> or another
auth function.</p></dd>


<dt>pps</dt>
<dd><p>an integer from 1 to 100 for the desired number of pages per
shard in the JSON output</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of HTTP responses</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function accesses a different API endpoint than the main
<code><a href="dai_async.html">dai_async()</a></code> function, one that has less language support, but
returns table data in addition to parsed text (which <code><a href="dai_async.html">dai_async()</a></code>
currently does not). This function may be deprecated if/when the v1
API endpoint incorporates table extraction. Use of this service
requires a GCS access token and some configuration of the .Renviron file;
see vignettes for details. Note that this API endpoint does not require
a Document AI processor id. Maximum pdf document length is 2,000 pages,
and the maximum number of pages in active processing is 10,000. Also note
that this function does not provide 'true' batch processing; instead it
successively submits single requests at 10-second intervals.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># with daiR configured on your system, several parameters are automatically provided,</span></span></span>
<span class="r-in"><span><span class="co"># and you can pass simple calls, such as:</span></span></span>
<span class="r-in"><span><span class="fu">dai_async_tab</span><span class="op">(</span><span class="st">"my_document.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NB: Include all parent bucket folders (but not the bucket name) in the filepath:</span></span></span>
<span class="r-in"><span><span class="fu">dai_async_tab</span><span class="op">(</span><span class="st">"for_processing/pdfs/my_document.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bulk process by passing a vector of filepaths in the files argument:</span></span></span>
<span class="r-in"><span><span class="fu">dai_async_tab</span><span class="op">(</span><span class="va">my_files</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify a bucket subfolder for the json output:</span></span></span>
<span class="r-in"><span><span class="fu">dai_async_tab</span><span class="op">(</span><span class="va">my_files</span>, dest_folder <span class="op">=</span> <span class="st">"processed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Hegghammer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

